<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <!--<meta name="viewport" content="user-scalable=yes, width=320" />-->
    <!--<meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1,user-scalable=0">-->
    <meta name="viewport" content="maximum-scale=1,initial-scale=1,user-scalable=1,width=device-width">

    <link href="build/main.css" rel="stylesheet">
    <!--<link href="index.css" rel="stylesheet">-->

    <title>Прототип распознавания голосовой команды активации в Я.Навигаторе</title>
    <script>

        // Команды активации
        window.yaWskPhrases = [
            'Слушай Яндекс',
            'Яндекс это я',
            'Яндекс ты здесь',
            'Ок Гугл',
            'Ок Яндекс',
            'Привет Яндекс',
            'Яндекс'
        ];

        /**
         * Запускает обработку голосовой активации
         * Получает распознанный текст произвольной команды
         *
         * onWskClicked(3) -->  Ждёт команду 'Ок Гугл'
         *
         * Так как WebSpeechKit работает асинхронно, функция не может вернуть распознанный текст
         * Получаем его по подписке, как в примере ниже.
         * Или в обработчике 'onDictationEnded' можно вызывать некий коллбек. Как вам удобнее.
         *
         * @param {Number} index Порядковый номер фразы активации в массиве window.yaWskPhrases
         */
        var onWskClicked = function(index, screen) {

            // Дождались, пока зарезолвятся модули
            window.modules.require(
                ['page-controller'],
                function () {

                    if (screen) {
                        window.yaWsk.debug(screen);
                    } else {
                        // Запустили обработку команды активации
                        window.yaWsk.run(index);

                        // Подписываемся на события распознавания произвольной команды
                        window.yaWsk.on('onDictationEnded', function (recognizedText) {
                            console.log(recognizedText);
                            window.yaWsk.recognizedText = recognizedText;
                        });
                    }
                }
            );
        };

    </script>
</head>
<body>

<div id="start">
    <h2 id="survey-head">Вам предстоит 7 заданий.</h2>
    <h3 id="task-head" class="hidden">Вы успешно прошли задание.</h3>
    <ol>
        <li>Нажмите "Cтарт" для начала задания №<span id="task-next">1</span></li>
        <li>Когда увидите интерфейс Навигатора, произнесите команду активации</li>
        <li>После чего выполняйте подсказки на экране.</li>
    </ol>
    <span id="btn">Старт</span>
</div>

<div id="content" class="hidden">
    <img src="i/main.jpg" style="height: 100%; max-height: 600px; opacity: 0.3" />

    <div class="controls-left">
        <img src="i/button_map_add_user_point.png" />
        <br><br>
        <img src="i/button_map_voice_find.png" />
    </div>

    <div class="controls-right">
        <img src="i/button_map_zoom_in.png" />
        <br><br>
        <img src="i/button_map_zoom_out.png" />
    </div>

    <div class="controls-bottom">
        <img src="i/button_map_find_me.png" />
    </div>

    <img class="dtp" src="i/dtp.png">

    <div class="bg">
        <div class="circle"></div>
        <div class="circle one"></div>
        <div class="circle two"></div>
        <div class="circle three"></div>

        <img class="mic" src="i/mic.png">
        <img class="car" src="i/car.png">
        <img class="compass" src="i/compass.png">

        <div class="actions">
            <span class="text speaking">Говорите</span>
            <span class="text processing">Обработка</span>
            <span id="custom-cmd" class="text event">"ДТП средний ряд"</span>
        </div>

        <div class="foot">
            <span class="text cancel">Отменить</span>
            <span class="text success">Событие добавлено!</span>
        </div>
    </div>
</div>


<div id="finish" class="hidden">
    <h2>Спасибо. Вы успешно прошли все задания.</h2>
    <a href="http://ya.ru">Вернуться в панель исследований</a>
</div>
<div class="messages" id="messages">
</div>

<script type="text/javascript" src="build/main.js"></script>
<!--<script type="text/javascript" src="node_modules/ym/modules.js"></script>-->
<!--<script type="text/javascript" src="node_modules/inherit/lib/inherit.js"></script>-->
<!--<script type="text/javascript" src="js/messages.js"></script>-->
<!--<script type="text/javascript" src="js/y-event-emitter/y-event-emitter.js"></script>-->
<!--<script type="text/javascript" src="js/webspeechkit-1.0.0.js"></script>-->
<!--<script type="text/javascript" src="js/webspeechkit-settings.js"></script>-->
<!--<script type="text/javascript" src="js/dom.js"></script>-->
<!--<script type="text/javascript" src="js/view.js"></script>-->
<!--<script type="text/javascript" src="js/wsk-controller.js"></script>-->
<!--<script type="text/javascript" src="js/page-controller.js"></script>-->
<script>
    onWskClicked(0, 3);
</script>

</body>
</html>
